Found 5059 subjects with both ECG data and mask files.
Training set: 4047 subjects
Found 5059 subjects with both ECG data and mask files.
Validation set: 1012 subjects
/home/awias/Documents/code/NLDL2026_WinterSchool/3DCLIP/train_clip3d_ecg.py:139: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler(init_scale=2**10, growth_interval=1000)
Traceback (most recent call last):
  File "/home/awias/Documents/code/NLDL2026_WinterSchool/3DCLIP/train_clip3d_ecg.py", line 284, in <module>
    train()
    ~~~~~^^
  File "/home/awias/Documents/code/NLDL2026_WinterSchool/3DCLIP/train_clip3d_ecg.py", line 153, in train
    progress_bar = tqdm(enumerate(dl_tr), total=len(dl_tr))
                        ~~~~~~~~~^^^^^^^
  File "/home/awias/miniconda3/envs/standard/lib/python3.14/site-packages/torch/utils/data/dataloader.py", line 500, in __iter__
    return self._get_iterator()
           ~~~~~~~~~~~~~~~~~~^^
  File "/home/awias/miniconda3/envs/standard/lib/python3.14/site-packages/torch/utils/data/dataloader.py", line 433, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/awias/miniconda3/envs/standard/lib/python3.14/site-packages/torch/utils/data/dataloader.py", line 1192, in __init__
    w.start()
    ~~~~~~~^^
  File "/home/awias/miniconda3/envs/standard/lib/python3.14/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
                  ~~~~~~~~~~~^^^^^^
  File "/home/awias/miniconda3/envs/standard/lib/python3.14/multiprocessing/context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/awias/miniconda3/envs/standard/lib/python3.14/multiprocessing/context.py", line 300, in _Popen
    return Popen(process_obj)
  File "/home/awias/miniconda3/envs/standard/lib/python3.14/multiprocessing/popen_forkserver.py", line 35, in __init__
    super().__init__(process_obj)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/awias/miniconda3/envs/standard/lib/python3.14/multiprocessing/popen_fork.py", line 20, in __init__
    self._launch(process_obj)
    ~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/awias/miniconda3/envs/standard/lib/python3.14/multiprocessing/popen_forkserver.py", line 51, in _launch
    self.sentinel, w = forkserver.connect_to_new_process(self._fds)
                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/home/awias/miniconda3/envs/standard/lib/python3.14/multiprocessing/forkserver.py", line 92, in connect_to_new_process
    raise ValueError('too many fds')
ValueError: too many fds
